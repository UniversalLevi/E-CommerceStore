<section class="main-cart" data-section-id="{{ section.id }}">
  <div class="page-width">
    <h1 class="main-cart__title h1">Your Cart</h1>

    {%- if cart.item_count > 0 -%}
      <form action="{{ routes.cart_url }}" method="post" id="cart-form" class="main-cart__form">
        <div class="main-cart__items">
          {%- for item in cart.items -%}
            <div class="main-cart__item" data-variant-id="{{ item.variant_id }}">
              <div class="main-cart__item-image">
                {%- if item.image -%}
                  <a href="{{ item.url }}">
                    <img
                      src="{{ item.image | image_url: width: 200 }}"
                      alt="{{ item.image.alt | default: item.title }}"
                      loading="lazy"
                      width="100"
                      height="133"
                    >
                  </a>
                {%- else -%}
                  <div class="main-cart__item-placeholder">
                    {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                  </div>
                {%- endif -%}
              </div>

              <div class="main-cart__item-details">
                <div class="main-cart__item-info">
                  <h3 class="main-cart__item-title">
                    <a href="{{ item.url }}">{{ item.product.title }}</a>
                  </h3>
                  {%- if item.variant.title != 'Default Title' -%}
                    <p class="main-cart__item-variant">{{ item.variant.title }}</p>
                  {%- endif -%}
                  <p class="main-cart__item-price">{{ item.price | money }}</p>
                </div>

                <div class="main-cart__item-quantity">
                  <label for="quantity-{{ item.index | plus: 1 }}" class="visually-hidden">Quantity</label>
                  <div class="main-cart__quantity-wrapper">
                    <button
                      type="button"
                      class="main-cart__quantity-button"
                      onclick="updateQuantity({{ item.index | plus: 1 }}, {{ item.quantity | minus: 1 }})"
                      aria-label="Decrease quantity"
                    >
                      âˆ’
                    </button>
                    <input
                      type="number"
                      id="quantity-{{ item.index | plus: 1 }}"
                      name="updates[]"
                      value="{{ item.quantity }}"
                      min="0"
                      class="main-cart__quantity-input"
                      aria-label="Quantity for {{ item.title }}"
                    >
                    <button
                      type="button"
                      class="main-cart__quantity-button"
                      onclick="updateQuantity({{ item.index | plus: 1 }}, {{ item.quantity | plus: 1 }})"
                      aria-label="Increase quantity"
                    >
                      +
                    </button>
                  </div>
                </div>

                <div class="main-cart__item-total">
                  {{ item.line_price | money }}
                </div>

                <a href="{{ item.url_to_remove }}" class="main-cart__item-remove" aria-label="Remove {{ item.title }}">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20" height="20">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                  </svg>
                </a>
              </div>
            </div>
          {%- endfor -%}
        </div>

        <div class="main-cart__footer">
          <div class="main-cart__note">
            <label for="cart-note">Order notes (optional)</label>
            <textarea id="cart-note" name="note" placeholder="Add a note to your order...">{{ cart.note }}</textarea>
          </div>

          <div class="main-cart__summary">
            <div class="main-cart__subtotal">
              <span>Subtotal</span>
              <span>{{ cart.total_price | money }}</span>
            </div>
            <p class="main-cart__taxes-note">Taxes and shipping calculated at checkout</p>
            
            <button type="submit" name="update" class="main-cart__update button--secondary">
              Update Cart
            </button>
            
            <button type="submit" name="checkout" class="main-cart__checkout button">
              Checkout
            </button>
          </div>
        </div>
      </form>
    {%- else -%}
      <div class="main-cart__empty">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="64" height="64">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
        </svg>
        <h2>Your cart is empty</h2>
        <p>Looks like you haven't added anything to your cart yet.</p>
        <a href="{{ routes.all_products_collection_url }}" class="button">
          Continue Shopping
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

<script>
  function updateQuantity(index, quantity) {
    const input = document.getElementById('quantity-' + index);
    if (input) {
      input.value = Math.max(0, quantity);
      document.getElementById('cart-form').submit();
    }
  }
</script>

<style>
  .main-cart {
    padding: var(--spacing-sections-mobile) 0;
  }

  @media screen and (min-width: 750px) {
    .main-cart {
      padding: var(--spacing-sections-desktop) 0;
    }
  }

  .main-cart__title {
    margin: 0 0 2rem;
    font-size: clamp(2rem, 4vw, 3rem);
  }

  .main-cart__items {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .main-cart__item {
    display: grid;
    grid-template-columns: 100px 1fr;
    gap: 1.5rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid rgba(var(--color-base-text), 0.1);
  }

  .main-cart__item-image img {
    width: 100%;
    height: auto;
    object-fit: cover;
  }

  .main-cart__item-placeholder {
    width: 100%;
    aspect-ratio: 3/4;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: rgba(var(--color-base-text), 0.05);
  }

  .main-cart__item-placeholder svg {
    width: 50%;
    height: 50%;
    opacity: 0.3;
  }

  .main-cart__item-details {
    display: grid;
    grid-template-columns: 1fr auto auto auto;
    gap: 1rem;
    align-items: start;
  }

  @media screen and (max-width: 749px) {
    .main-cart__item-details {
      grid-template-columns: 1fr auto;
      grid-template-rows: auto auto;
    }
  }

  .main-cart__item-title {
    margin: 0 0 0.25rem;
    font-size: 1rem;
    font-weight: 500;
  }

  .main-cart__item-title a {
    color: inherit;
    text-decoration: none;
  }

  .main-cart__item-title a:hover {
    text-decoration: underline;
  }

  .main-cart__item-variant {
    margin: 0;
    font-size: 0.875rem;
    opacity: 0.7;
  }

  .main-cart__item-price {
    margin: 0.5rem 0 0;
    font-size: 0.875rem;
  }

  .main-cart__quantity-wrapper {
    display: flex;
    align-items: center;
    border: 1px solid rgba(var(--color-base-text), 0.2);
  }

  .main-cart__quantity-button {
    padding: 0.5rem 0.75rem;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    color: rgb(var(--color-base-text));
  }

  .main-cart__quantity-button:hover {
    background-color: rgba(var(--color-base-text), 0.05);
  }

  .main-cart__quantity-input {
    width: 50px;
    padding: 0.5rem;
    text-align: center;
    border: none;
    background: transparent;
    font-size: 1rem;
    color: rgb(var(--color-base-text));
  }

  .main-cart__quantity-input::-webkit-inner-spin-button,
  .main-cart__quantity-input::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  .main-cart__item-total {
    font-weight: 600;
    min-width: 80px;
    text-align: right;
  }

  .main-cart__item-remove {
    color: rgb(var(--color-base-text));
    opacity: 0.5;
    transition: opacity 0.2s ease;
  }

  .main-cart__item-remove:hover {
    opacity: 1;
  }

  .main-cart__footer {
    display: grid;
    gap: 2rem;
  }

  @media screen and (min-width: 750px) {
    .main-cart__footer {
      grid-template-columns: 1fr 300px;
    }
  }

  .main-cart__note label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
    font-weight: 500;
  }

  .main-cart__note textarea {
    width: 100%;
    padding: 1rem;
    border: 1px solid rgba(var(--color-base-text), 0.2);
    background: transparent;
    color: rgb(var(--color-base-text));
    font-family: inherit;
    font-size: 0.875rem;
    resize: vertical;
    min-height: 100px;
  }

  .main-cart__summary {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .main-cart__subtotal {
    display: flex;
    justify-content: space-between;
    font-size: 1.25rem;
    font-weight: 600;
  }

  .main-cart__taxes-note {
    margin: 0;
    font-size: 0.75rem;
    opacity: 0.7;
  }

  .main-cart__update,
  .main-cart__checkout {
    width: 100%;
    padding: 1rem;
    font-size: 0.875rem;
    cursor: pointer;
  }

  .button--secondary {
    background: transparent;
    border: 1px solid rgb(var(--color-base-text));
    color: rgb(var(--color-base-text));
  }

  .button--secondary:hover {
    background-color: rgb(var(--color-base-text));
    color: rgb(var(--color-base-background-1));
  }

  .main-cart__empty {
    text-align: center;
    padding: 4rem 2rem;
  }

  .main-cart__empty svg {
    opacity: 0.3;
    margin-bottom: 1rem;
  }

  .main-cart__empty h2 {
    margin: 0 0 0.5rem;
  }

  .main-cart__empty p {
    margin: 0 0 2rem;
    opacity: 0.7;
  }
</style>

{% schema %}
{
  "name": "Cart Page",
  "tag": "section",
  "class": "section-main-cart",
  "settings": []
}
{% endschema %}

